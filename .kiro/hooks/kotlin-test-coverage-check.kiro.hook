{
  "enabled": true,
  "name": "Kotlin Test Coverage Checker",
  "description": "When a Kotlin file is saved in core/rules, core/domain, or core/data, check if corresponding test file exists and meets coverage targets (90%/85%/80% respectively). Optionally run tests for that module.",
  "version": "1",
  "when": {
    "type": "fileEdited",
    "patterns": [
      "core/rules/**/*.kt",
      "core/domain/**/*.kt",
      "core/data/**/*.kt"
    ]
  },
  "then": {
    "type": "askAgent",
    "prompt": "A Kotlin file has been modified in one of the core modules. Please:\n\n1. Identify which module the file belongs to (core/rules, core/domain, or core/data)\n2. Determine the expected test coverage target:\n   - core/rules: 90%+\n   - core/domain: 85%+\n   - core/data: 80%+\n3. Check if a corresponding test file exists (e.g., for `Creature.kt`, look for `CreatureTest.kt` in the test directory)\n4. If no test file exists, notify the user and suggest creating one\n5. If a test file exists, analyze whether it appears to have adequate coverage for the modified code\n6. Optionally offer to run the module's tests using: `gradle :core:{module}:test`\n7. Remind the user of the coverage target for this module\n\nModified files: {{CHANGED_FILES}}\n\nPlease provide a concise analysis and actionable recommendations."
  }
}